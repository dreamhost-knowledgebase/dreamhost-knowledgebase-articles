<h2>Key pairs</h2>
<p>When launching an instance, you can inject a <em>key pair</em> which provides SSH access to the instance. For this to work, the image must contain the <code class="docutils literal"><span class="pre">cloud-init</span></code> package.</p>
<p>When you create a key pair for a project, you can then use that key pair for multiple instances that belong to that project.</p>
<p>If you generate a key pair with an external tool, you can <a href="https://help.dreamhost.com/hc/en-us/articles/214843617-How-to-upload-an-SSH-key-via-the-DreamCompute-dashboard">import it into DreamCompute</a>.</p>
<div class="alert alert-important">
<div class="alert-icon"><img src="https://objects-us-west-1.dream.io/kbimages/images/dh-kb-important-icon.svg" width="60" height="60" /></div>
<div class="alert-content">
<p>A key pair belongs to an individual user, not to a project. To share a key pair across multiple users, each user needs to import that key pair.</p>
</div>
</div>
<p>If an image uses a static root password or a static key set (neither is recommended), you must not provide a key pair when you launch the instance.</p>
<h2>Security groups</h2>
<p>A <em>security group</em> is a named collection of network access rules. These access rules are used to limit the types of traffic that have access to instances. When you launch an instance, you can assign one or more security groups to it. If you do not create or specify a security group, new instances are automatically assigned to the 'default' security group.</p>
<p>The associated <em>rules</em> in each security group control the traffic to instances in the group. Any incoming traffic that is not matched by a rule is denied access by default.</p>
<p>You can add, remove, or modify rules from a security group you have created. You can also modify rules for the default security group.</p>
<p>You can also modify the rules to allow access to instances through different ports and protocols. For example, you can modify rules to allow a service on an instance (like a web server) to be visible to the internet or to allow UDP traffic (like a DNS server running on an instance). You specify the following parameters for rules:</p>
<ul class="simple">
<li><strong>Source of traffic</strong>— Enable traffic to instances from IP addresses inside the cloud from other group members, or from all IP addresses.</li>
<li><strong>Protocol</strong> — TCP, ICMP, or UDP.</li>
<li><strong>Destination port on virtual machine </strong>— Define a port range. ICMP does not support ports; instead, enter values to define the codes and types of ICMP traffic to be allowed.</li>
</ul>
<p>Rules are automatically enforced as soon as you create or modify them.</p>
<div class="alert alert-note">
<div class="alert-icon"><img src="https://objects-us-west-1.dream.io/kbimages/images/dh-kb-note-icon.svg" width="60" height="60" /></div>
<div class="alert-content">
<p>This tutorial assumes that you have installed the OpenStack client and sourced your project's RC file. If you need help with those tasks, see our articles here:</p>
<ul>
<li><a href="https://help.dreamhost.com/hc/en-us/articles/235817468-Getting-started-with-the-OpenStack-command-line-client">Getting started with the OpenStack command line client</a></li>
<li><a href="https://help.dreamhost.com/hc/en-us/articles/228047207-How-to-download-your-DreamCompute-openrc-file">How to download your DreamCompute openrc file</a></li>
<li><a href="https://help.dreamhost.com/hc/en-us/articles/115002627271-How-to-work-with-DreamCompute-in-Windows">How to work with DreamCompute in Windows</a></li>
</ul>
</div>
</div>
<div class="alert alert-note">
<div class="alert-icon"><img src="https://objects-us-west-1.dream.io/kbimages/images/dh-kb-note-icon.svg" width="60" height="60" /></div>
<div class="alert-content">
<p>Some of the examples below contain a forward slash character at the end of each line. This forward slash continues the command on the next line. If you like, you can remove this character and put the entire command on a single line.</p>
</div>
</div>
<div id="add-a-key-pair">
<h2>Adding and importing Key pairs</h2>
<p>You can generate a key pair or upload an existing public key.</p>
<h3>Adding a Key pair</h3>
<p>To generate a key pair, run the following command.</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack keypair create KEY_NAME &gt; MY_KEY.pem</span>
</pre>
</div>
<p>This command generates a key pair with the name that you specify for KEY_NAME, writes the private key to the <code class="docutils literal"><span class="pre">.pem</span></code> file that you specify, and registers the public key in your DreamCompute project.</p>
</div>
<div id="import-a-key-pair">
<h3>Importing a key pair</h3>
<ol class="arabic">
<li>
<p class="first">If you have already generated a key pair on your Linux or Mac computer, it is most likely named 'id_rsa.pub' and located in the directory: <code class="docutils literal"><span class="pre">~/.ssh/id_rsa.pub</span></code>. Run the following command to upload the public key.</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack keypair create --public-key \
~/.ssh/id_rsa.pub KEY_NAME</span>
</pre>
</div>
<p>This command registers the public key in your DreamCompute project and names the key pair the name that you specify for <code class="docutils literal"><span class="pre">KEY_NAME</span></code>.</p>
</li>
<li>
<p class="first">To ensure that the key pair has been successfully imported, run the following command to list key pairs:</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack keypair list</span>
</pre>
</div>
</li>
</ol>
</div>
<div id="create-and-manage-security-groups">
<h2>Security groups</h2>
<p>List the security groups for the current project (including descriptions):</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack security group list</span>
</pre>
</div>
<p>Create a security group with a specified name and description (optional):</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack security group create \
--description GROUP_DESCRIPTION SECURITY_GROUP_NAME</span>
+-------------+-----------------------+
| Field       | Value                 |
+-------------+-----------------------+
| description | GROUP_DESCRIPTION     |
| id          | 18fb88bb-7362-4349... |
| name        | SECURITY_GROUP_NAME   |
| rules       | []                    |
| tenant_id   | TENANTID              |
+-------------+-----------------------+
</pre>
</div>
<p>Delete a specified group:</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack security group delete SECURITY_GROUP_NAME</span>
</pre>
</div>
<div class="alert alert-important">
<div class="alert-icon"><img src="https://objects-us-west-1.dream.io/kbimages/images/dh-kb-important-icon.svg" width="60" height="60" /></div>
<div class="alert-content">
<p>You cannot delete the 'default' security group from your project. It's also not possible to delete a security group that is assigned to an instance.</p>
</div>
</div>
<div id="create-and-manage-security-group-rules">
<h2>Create and manage security group rules</h2>
<p>You can modify security group rules with the <span class="code">openstack security group rule *</span> command.</p>
<h3>List the rules for a security group</h3>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack security group rule list SECURITY_GROUP_NAME</span>
</pre>
</div>
<h3>Allow requests to port 8080</h3>
<p>To allow requests to port 8080 on all instances using this group, choose one of the following options:</p>
<ul>
<li>Allow access from all IP addresses (specified as IP subnet <code class="docutils literal"><span class="pre">0.0.0.0/0</span></code> in CIDR notation).
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack security group rule create \
--proto tcp --dst-port 8080 SECURITY_GROUP_NAME</span>
+-----------------------+-----------------------+
| Field                 | Value                 |
+-----------------------+-----------------------+
| id                    | 88cbb9a5-f637-4151... |
| ip_protocol           | tcp                   |
| ip_range              | 0.0.0.0/0             |
| parent_group_id       | 932633da-b130-4365... |
| port_range            | 8080:8080             |
| remote_security_group |                       |
+-----------------------+-----------------------+
</pre>
</div>
</li>
<li>Allow access only from IP addresses from other security groups (source groups) to access the specified port.
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack security group rule create --proto tcp \
--dst-port 8080 --src-group SOURCE_GROUP_ID SECURITY_GROUP_NAME</span>
+-----------------------+-----------------------+
| Field                 | Value                 |
+-----------------------+-----------------------+
| id                    | 21cb0ce6-5765-41c6... |
| ip_protocol           | tcp                   |
| ip_range              |                       |
| parent_group_id       | 932633da-b130-4365... |
| port_range            | 8080:8080             |
| remote_security_group | SOURCE_GROUP_NAME     |
+-----------------------+-----------------------+
</pre>
</div>
<div class="alert alert-note">
<div class="alert-icon"><img src="https://objects-us-west-1.dream.io/kbimages/images/dh-kb-note-icon.svg" width="60" height="60" /></div>
<div class="alert-content">
<p>Use the <span class="code">openstack security group list command to obtain the desired SOURCE_GROUP_ID.</span></p>
</div>
</div>
</li>
</ul>
<h3>Allow access through a UDP port</h3>
<p>To allow access through a UDP port, such as allowing access to a DNS server that runs on an instance, choose one of the following options:</p>
<ul>
<li>Allow UDP access from all IP addresses (specified as IP subnet <code class="docutils literal"><span class="pre">0.0.0.0/0</span></code> in CIDR notation).
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack security group rule create \
--proto udp --dst-port 53 SECURITY_GROUP_NAME</span>
+-----------------------+-----------------------+
| Field                 | Value                 |
+-----------------------+-----------------------+
| id                    | 0686f2be-17b5-41f9... |
| ip_protocol           | udp                   |
| ip_range              | 0.0.0.0/0             |
| parent_group_id       | 932633da-b130-4365... |
| port_range            | 53:53                 |
| remote_security_group |                       |
+-----------------------+-----------------------+
</pre>
</div>
</li>
<li>
<p class="first">Allow only IP addresses from other security groups (source groups) to access the specified port.</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack security group rule create --proto udp \
--dst-port 53 --src-group SOURCE_GROUP_ID SECURITY_GROUP_NAME</span>
+-----------------------+-----------------------+
| Field                 | Value                 |
+-----------------------+-----------------------+
| id                    | 61bd6d8e-5ad7-4773... |
| ip_protocol           | udp                   |
| ip_range              |                       |
| parent_group_id       | 932633da-b130-4365... |
| port_range            | 53:53                 |
| remote_security_group | SOURCE_GROUP_NAME     |
+-----------------------+-----------------------+
</pre>
</div>
</li>
</ul>
</div>
<div id="delete-a-security-group-rule">
<h2>Delete a security group rule</h2>
<p>To delete a security group rule, specify the same arguments that you used to create the rule.</p>
<p>For example, to delete the security group rule that permits access to port 8080 from all IP addresses, look up that rule's ID using the <span class="code">openstack security group rule list</span> command above, then run the following command.</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[user@localhost]$ </span><span class="command">openstack security group rule delete SECURITY_GROUP_RULE_ID</span>
</pre>
</div>
</div>
</div>
