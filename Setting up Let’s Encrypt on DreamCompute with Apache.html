<div class="document">
<div class="documentwrapper">
<div class="body">
<div id="setting-up-let-s-encrypt-on-dreamcompute-with-apache">
<div id="what-is-let-s-encrypt">
<h2>What is Let’s Encrypt?</h2>
<p><a class="reference external" href="https://letsencrypt.org">Let’s Encrypt</a> is a new certificate authority that provides absolutely free secure certificates to help get the Internet to 100% HTTPS on the Internet.</p>
<p>DreamHost has integrated Let’s Encrypt support into its panel for hosted services, but if you want to set up automatically-renewing certificates for domains you host on a DreamCompute instance, you’ll need to do a little bit of manual installation. But the good news is, it doesn’t take long, and once you finish the setup, you should never have to worry about renewing a certificate ever again!</p>
</div>
<div id="get-the-code">
<h2>Get the code</h2>
<p>Start by logging into your DreamCompute instance. It shouldn’t matter too much which distribution of Linux you’re running, but make sure you have the <code class="docutils literal"><span class="pre">git</span></code> package installed so that you can clone the letsencrypt repository, like so:</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[root@server]# </span><span class="command">sudo -s</span>
<span class="server">[root@server]# </span><span class="command">cd /opt</span>
<span class="server">[root@server]# </span><span class="command">git clone git://github.com/certbot/certbot</span></pre>
</div>
<div id="get-your-first-certificate">
<h2>Get your first certificate</h2>
<p>Before you do this, you’ll need to make sure that your domain is actually pointing at your DreamCompute instance’s IP address, and that your webserver is configured to respond to requests for your domain name. This is required because 'Let’s Encrypt' performs checks to make sure that you control domain names that you request certificates for. If you have not already done this, view the article below for assistance:</p>
<ul>
<li><a href="https://help.dreamhost.com/hc/en-us/articles/218672058-Configuring-DNS-for-your-domains">Configuring DNS for your domains</a></li>
</ul>
<p>You must also make sure that you have Apache already configured properly to respond to requests for <code class="docutils literal"><span class="pre">example.com</span></code>.</p>
<ul>
<li><a href="https://help.dreamhost.com/hc/en-us/articles/215879457-How-to-Configure-Apache-on-DreamCompute-Running-Debian-or-Ubuntu" target="_blank" rel="noopener">How to Configure Apache on DreamCompute Running Debian or Ubuntu</a></li>
<li><a href="https://help.dreamhost.com/hc/en-us/articles/115003441752-Adding-a-website-to-DreamCompute">Adding a website to DreamCompute</a></li>
</ul>
<p>Once your site is configured and responding to the default Apache page, proceed with isntalling  the Apache plugin for certbot-auto like so:</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[root@server]# </span><span class="command">/opt/certbot/certbot-auto --apache -d example.com</span></pre>
</div>
<p>This will prompt you for some information including your email address. The last question you're asked is if you want to redirect all traffic to the https version of your site's URL. It's highly recommended that you choose to do this. Type the number '2' to choose this option. For example:</p>
<div class="preboxcontainer">
<pre class="prebox">Please choose whether or not to redirect HTTP traffic to HTTPS, removing HTTP access.
-------------------------------------------------------------------------------
1: No redirect - Make no further changes to the webserver configuration.
2: Redirect - Make all requests redirect to secure HTTPS access. Choose this for
new sites, or if you're confident your site works on HTTPS. You can undo this
change by editing your web server's configuration.
-------------------------------------------------------------------------------
Select the appropriate number [1-2] then [enter] (press 'c' to cancel): <span class="command">2</span>
Enabled Apache rewrite module
Redirecting vhost in /etc/apache2/sites-enabled/example.com.conf to ssl vhost in /etc/apache2/sites-available/example.com-le-ssl.conf</pre>
</div>
<p>This will finalize your new certificate. You shouldn’t even need to restart your webserver or modify a configuration file as the Apache plugin for certbot-auto was designed to handle this for you.</p>
</div>
<div id="adding-a-subdomain-to-an-existing-certificate">
<h2>Adding a subdomain to an existing certificate</h2>
<p>If after running that script you realize that you also need a certificate for a related subdomain, you can run the certbot-auto command again with additional parameters.</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">[root@server]# </span><span class="command">/opt/certbot/certbot -auto --apache -d example.com -d sub.example.com</span></pre>
</div>
<div id="automatic-renewal">
<h2>Automatic renewal</h2>
<p>You can have your system automatically renew all of the certificates for you using a small shell script which looks like this:</p>
<div class="preboxcontainer">
<pre class="prebox">#!/bin/bash

/opt/certbot/certbot-auto renew</pre>
</div>
<p>If you save that script in the <strong><cite>/usr/local/bin</cite></strong> directory as something like 'update_certs', you can schedule the script to run once a week with <code>cron&gt;</code> like so:</p>
<div class="preboxcontainer">
<pre class="prebox">30 0 * * 0 /usr/local/bin/update_certs</pre>
</div>
<p>Now, your system attempts to renew all of your certificates once a week. If there are no certificates in danger of expiring soon, nothing bad happens. But if any would have otherwise expired, then they get renewed automatically.</p>
</div>
<div class="footer"> </div>
<!--DreamCompute Button-->
<div class="dream-sign-up">
<h2 id="h_849006449121518042594193">Deploy Your Apps On Cloud Servers Today</h2>
<a href="http://www.dreamhost.com/cloud/computing">Sign Up for DreamCompute</a></div>
</div>
</div>
</div>
</div>
</div>
</div>
