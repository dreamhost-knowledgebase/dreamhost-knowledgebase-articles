<body>
<div class="document">
<div class="documentwrapper">
<div class="body" role="main">
<div id="how-to-use-the-openstack-compute-api-on-dreamcompute">

<p>To use the information in this section, you must be familiar with
OpenStack Compute.</p>
<div id="set-environment-variables">
<h2>Set environment variables</h2>
<p>To set up environmental variables and authenticate against Compute API
endpoints, see <a class="reference external" href="216511257-Overview-of-authentication-in-DreamCompute">Overview of authentication in DreamCompute</a>.</p>
</div>
<div id="get-openstack-credentials-api-v2">
<span id="get-openstack-credentials"></span><h2>Get OpenStack credentials (API v2)</h2>
<p>This example uses the <code class="docutils literal"><span class="pre">get_nova_credentials_v2</span></code> method:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_nova_credentials_v2</span><span class="p">():</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'2'</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'OS_USERNAME'</span><span class="p">]</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">'api_key'</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'OS_PASSWORD'</span><span class="p">]</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">'auth_url'</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'OS_AUTH_URL'</span><span class="p">]</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">'project_id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'OS_TENANT_NAME'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">d</span>
</pre></div>
</div>
<p>This code resides in the <code class="docutils literal"><span class="pre">credentials.py</span></code> file, which all samples
import.</p>
<p>Use the <code class="docutils literal"><span class="pre">get_nova_credentials_v2()</span></code> method to populate and get a
dictionary:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">credentials</span> <span class="o">=</span> <span class="n">get_nova_credentials_v2</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div id="list-servers-api-v2">
<h2>List servers (API v2)</h2>
<p>The following program lists servers by using the Compute API v2.</p>
<ol class="arabic">
<li>
<p class="first">Import the following modules:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Get Nova credentials. See <a class="reference internal" href="#get-openstack-credentials"><span>Get OpenStack credentials (API v2)</span></a>.</p>
</li>
<li>
<p class="first">Instantiate the <code class="docutils literal"><span class="pre">nova_client</span></code> client object by using the
<code class="docutils literal"><span class="pre">credentials</span></code> dictionary object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">List servers by calling <code class="docutils literal"><span class="pre">servers.list</span></code> on <code class="docutils literal"><span class="pre">nova_client</span></code> object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>
</pre></div>
</div>
</li>
</ol>
<div id="list-server-code-listing-example">
<h3>List server code listing example</h3>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">get_nova_credentials_v2</span><span class="p">()</span>
<span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div id="create-server-api-v2">
<h2>Create server (API v2)</h2>
<p>The following program creates a server (VM) by using the Compute API v2.</p>
<ol class="arabic">
<li>
<p class="first">Import the following modules:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Get OpenStack credentials. See <a class="reference internal" href="#get-openstack-credentials"><span>Get OpenStack credentials (API v2)</span></a>.</p>
</li>
<li>
<p class="first">Instantiate the <code class="docutils literal"><span class="pre">nova_client</span></code> client object by using the
<code class="docutils literal"><span class="pre">credentials</span></code> dictionary object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Get the flavor and image to use to create a server. This code uses
the <code class="docutils literal"><span class="pre">cirros</span></code> image, the <code class="docutils literal"><span class="pre">m1.tiny</span></code> flavor, and the <code class="docutils literal"><span class="pre">private</span></code>
network:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"cirros"</span><span class="p">)</span>
<span class="n">flavor</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">flavors</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"m1.tiny"</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">"private"</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">To create the server, use the network, image, and flavor:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">nics</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">'net-id'</span><span class="p">:</span> <span class="n">net</span><span class="o">.</span><span class="n">id</span><span class="p">}]</span>
<span class="n">instance</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"vm2"</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
<span class="n">flavor</span><span class="o">=</span><span class="n">flavor</span><span class="p">,</span> <span class="n">key_name</span><span class="o">=</span><span class="s2">"keypair-1"</span><span class="p">,</span> <span class="n">nics</span><span class="o">=</span><span class="n">nics</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Run the “Sleep for five seconds” command, and determine whether
the server/vm was created by calling <code class="docutils literal"><span class="pre">nova_client.servers.list()</span></code>:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">"Sleeping for 5s after create command"</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"List of VMs"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>
</pre></div>
</div>
</li>
</ol>
<div id="create-server-code-listing-example">
<h3>Create server code listing example</h3>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_nova_credentials_v2</span><span class="p">()</span>
    <span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>

    <span class="n">image</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"cirros"</span><span class="p">)</span>
    <span class="n">flavor</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">flavors</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"m1.tiny"</span><span class="p">)</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">"private"</span><span class="p">)</span>
    <span class="n">nics</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">'net-id'</span><span class="p">:</span> <span class="n">net</span><span class="o">.</span><span class="n">id</span><span class="p">}]</span>
    <span class="n">instance</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"vm2"</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
                                      <span class="n">flavor</span><span class="o">=</span><span class="n">flavor</span><span class="p">,</span> <span class="n">key_name</span><span class="o">=</span><span class="s2">"keypair-1"</span><span class="p">,</span> <span class="n">nics</span><span class="o">=</span><span class="n">nics</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"Sleeping for 5s after create command"</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"List of VMs"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"Execution Completed"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div id="delete-server-api-v2">
<h2>Delete server (API v2)</h2>
<p>The following program deletes a server (VM) by using the Compute API v2.</p>
<ol class="arabic">
<li>
<p class="first">Import the following modules:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Get Nova credentials. See <a class="reference internal" href="#get-openstack-credentials"><span>Get OpenStack credentials (API v2)</span></a>.</p>
</li>
<li>
<p class="first">Instantiate the <code class="docutils literal"><span class="pre">nova_client</span></code> client object by using the
<code class="docutils literal"><span class="pre">credentials</span></code> dictionary object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Determine whether the <code class="docutils literal"><span class="pre">vm1</span></code> server exists:</p>
<ol class="loweralpha simple">
<li>List servers: <code class="docutils literal"><span class="pre">servers_list</span></code>.</li>
<li>Iterate over <code class="docutils literal"><span class="pre">servers_list</span></code> and compare name with <code class="docutils literal"><span class="pre">vm1</span></code>.</li>
<li>If true, set the variable name <code class="docutils literal"><span class="pre">server_exists</span></code> to <code class="docutils literal"><span class="pre">True</span></code>
and break from the for loop:</li>
</ol>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">servers_list</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">server_del</span> <span class="o">=</span> <span class="s2">"vm1"</span>
<span class="n">server_exists</span> <span class="o">=</span> <span class="bp">False</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">servers_list</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">server_del</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">"This server </span><span class="si">%s</span><span class="s2"> exists"</span> <span class="o">%</span> <span class="n">server_del</span><span class="p">)</span>
        <span class="n">server_exists</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">break</span>
</pre></div>
</div>
</li>
<li>
<p class="first">If the server exists, run the <code class="docutils literal"><span class="pre">delete</span></code> method of the
<code class="docutils literal"><span class="pre">nova_client.servers</span></code> object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<div id="delete-server-code-example">
<h3>Delete server code example</h3>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">get_nova_credentials_v2</span><span class="p">()</span>
<span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>

<span class="n">servers_list</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">server_del</span> <span class="o">=</span> <span class="s2">"vm1"</span>
<span class="n">server_exists</span> <span class="o">=</span> <span class="bp">False</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">servers_list</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">server_del</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">"This server </span><span class="si">%s</span><span class="s2"> exists"</span> <span class="o">%</span> <span class="n">server_del</span><span class="p">)</span>
        <span class="n">server_exists</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">break</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">server_exists</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"server </span><span class="si">%s</span><span class="s2"> does not exist"</span> <span class="o">%</span> <span class="n">server_del</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"deleting server.........."</span><span class="p">)</span>
    <span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"server </span><span class="si">%s</span><span class="s2"> deleted"</span> <span class="o">%</span> <span class="n">server_del</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div id="update-server-api-v2">
<h2>Update server (API v2)</h2>
<p>The following program updates the name of a server (VM) by using the
Compute API v2.</p>
<ol class="arabic">
<li>
<p class="first">Import the following modules:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">print_server</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">print_server</span></code> is a method defined in <code class="docutils literal"><span class="pre">utils.py</span></code> and prints the
server details as shown in the code listing below:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_server</span><span class="p">(</span><span class="n">server</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"-"</span><span class="o">*</span><span class="mi">35</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"server id: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">server</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"server name: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">server</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"server image: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">server</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"server flavor: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">server</span><span class="o">.</span><span class="n">flavor</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"server key name: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">server</span><span class="o">.</span><span class="n">key_name</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"user_id: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">server</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"-"</span><span class="o">*</span><span class="mi">35</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Get OpenStack Credentials. See <a class="reference internal" href="#get-openstack-credentials"><span>Get OpenStack credentials
(API v2)</span></a>.</p>
</li>
<li>
<p class="first">Instantiate the <code class="docutils literal"><span class="pre">nova_client</span></code> client object by using the
<code class="docutils literal"><span class="pre">credentials</span></code> dictionary object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Get the server instance using <code class="docutils literal"><span class="pre">server_id</span></code> and print the details by
calling <code class="docutils literal"><span class="pre">print_server</span></code> method:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">server_id</span> <span class="o">=</span> <span class="s1">'99889c8d-113f-4a7e-970c-77f1916bfe14'</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">server_id</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">name</span>
<span class="n">print_server</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Call <code class="docutils literal"><span class="pre">server.update</span></code> on the server object with the new value for
<code class="docutils literal"><span class="pre">name</span></code> variable:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">server</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="s1">'1'</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Get the updated instance of the server:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">server_updated</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">server_id</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Call <code class="docutils literal"><span class="pre">print_server</span></code> again to check the update server details:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">print_server</span><span class="p">(</span><span class="n">server_updated</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<div id="update-server-code-listing-example">
<h3>Update server code listing example</h3>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">print_server</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">get_nova_credentials_v2</span><span class="p">()</span>
<span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>

<span class="c1"># Change the server_id specific to your environment</span>

<span class="n">server_id</span> <span class="o">=</span> <span class="s1">'99889c8d-113f-4a7e-970c-77f1916bfe14'</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">server_id</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">name</span>
<span class="n">print_server</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>

<span class="n">server</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">n</span> <span class="o">+</span><span class="s1">'1'</span><span class="p">)</span>
<span class="n">server_updated</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">server_id</span><span class="p">)</span>
<span class="n">print_server</span><span class="p">(</span><span class="n">server_updated</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div id="list-flavors-api-v2">
<h2>List flavors (API v2)</h2>
<p>The following program lists flavors and their details by using the
Compute API v2.</p>
<ol class="arabic">
<li>
<p class="first">Import the following modules:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">print_flavors</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">print_flavors</span></code> method is defined in <code class="docutils literal"><span class="pre">utils.py</span></code> and prints the
flavor details:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_flavors</span><span class="p">(</span><span class="n">flavor_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">flavor</span> <span class="ow">in</span> <span class="n">flavor_list</span><span class="p">:</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">"-"</span><span class="o">*</span><span class="mi">35</span><span class="p">)</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">"flavor id : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">flavor</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">"flavor name : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">flavor</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">"-"</span><span class="o">*</span><span class="mi">35</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Get OpenStack credentials. <a class="reference internal" href="#get-openstack-credentials"><span>Get OpenStack credentials
(API v2)</span></a>.</p>
</li>
<li>
<p class="first">Instantiate the <code class="docutils literal"><span class="pre">nova_client</span></code> client object by using the
<code class="docutils literal"><span class="pre">credentials</span></code> dictionary object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">List flavors by calling <code class="docutils literal"><span class="pre">list()</span></code> on <code class="docutils literal"><span class="pre">nova_client.flavors</span></code> object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">flavors_list</span> <span class="o">=</span>  <span class="n">nova_client</span><span class="o">.</span><span class="n">flavors</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Print the flavor details, id and name by calling <code class="docutils literal"><span class="pre">print_flavors</span></code>:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">print_flavors</span><span class="p">(</span><span class="n">flavors_list</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<div id="list-flavors-code-listing-example">
<h3>List flavors code listing example</h3>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">print_flavors</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">get_nova_credentials_v2</span><span class="p">()</span>
<span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>

<span class="n">flavors_list</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">flavors</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">print_flavors</span><span class="p">(</span><span class="n">flavors_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div id="list-floating-ips-api-v2">
<h2>List floating IPs (API v2)</h2>
<p>The following program lists the floating IPs and their details by using
the Compute API v2.</p>
<ol class="arabic">
<li>
<p class="first">Import the following modules:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">print_values_ip</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">print_values_ip</span></code> method is defined in <code class="docutils literal"><span class="pre">utils.py</span></code> and prints the
floating_ip object details:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_values_ip</span><span class="p">(</span><span class="n">ip_list</span><span class="p">):</span>
    <span class="n">ip_dict_lisl</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">ip_list</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">"-"</span><span class="o">*</span><span class="mi">35</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">"fixed_ip : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">ip</span><span class="o">.</span><span class="n">fixed_ip</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">"id : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">ip</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">"instance_id : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">ip</span><span class="o">.</span><span class="n">instance_id</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">"ip : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">ip</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">"pool : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">ip</span><span class="o">.</span><span class="n">pool</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Get OpenStack credentials. See <a class="reference internal" href="#get-openstack-credentials"><span>Get OpenStack credentials
(API v2)</span></a>.</p>
</li>
<li>
<p class="first">Instantiate the <code class="docutils literal"><span class="pre">nova_client</span></code> client object by using the
<code class="docutils literal"><span class="pre">credentials</span></code> dictionary object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">List floating IPs by calling <code class="docutils literal"><span class="pre">list()</span></code> on <code class="docutils literal"><span class="pre">nova_client.floating_ips</span></code>
object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">ip_list</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">floating_ips</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Print the floating IP object details by calling <code class="docutils literal"><span class="pre">print_values_ip</span></code>:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">print_values_ip</span><span class="p">(</span><span class="n">ip_list</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<div id="list-floating-ips-code-listing-example">
<h3>List floating IPs code listing example</h3>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">print_values_ip</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">get_nova_credentials_v2</span><span class="p">()</span>
<span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>
<span class="n">ip_list</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">floating_ips</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">print_values_ip</span><span class="p">(</span><span class="n">ip_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div id="list-hosts-api-v2">
<h2>List hosts (API v2)</h2>
<p>The following program lists the hosts by using the Compute API v2.</p>
<ol class="arabic">
<li>
<p class="first">Import the following modules:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">print_hosts</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">print_hosts</span></code> method is defined in <code class="docutils literal"><span class="pre">utils.py</span></code> and prints the
host object details:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_hosts</span><span class="p">(</span><span class="n">host_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">host_list</span><span class="p">:</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">"-"</span><span class="o">*</span><span class="mi">35</span><span class="p">)</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">"host_name : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">host</span><span class="o">.</span><span class="n">host_name</span><span class="p">)</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">"service : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">host</span><span class="o">.</span><span class="n">service</span><span class="p">)</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">"zone : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">host</span><span class="o">.</span><span class="n">zone</span><span class="p">)</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">"-"</span><span class="o">*</span><span class="mi">35</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Get OpenStack credentials. See <a class="reference internal" href="#get-openstack-credentials"><span>Get OpenStack credentials (API v2)</span></a>.</p>
</li>
<li>
<p class="first">Instantiate the <code class="docutils literal"><span class="pre">nova_client</span></code> client object by using the
<code class="docutils literal"><span class="pre">credentials</span></code> dictionary object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li>
<p class="first">List hosts by calling <code class="docutils literal"><span class="pre">list()</span></code> on <code class="docutils literal"><span class="pre">nova_client.hosts</span></code> object:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">host_list</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">hosts</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Print the host object details by calling <code class="docutils literal"><span class="pre">print_hosts(host_list)</span></code>:</p>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="n">print_hosts</span><span class="p">(</span><span class="n">host_list</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<div id="list-hosts-code-listing-example">
<h3>List hosts code listing example</h3>
<div class="highlight-python">
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">credentials</span> <span class="kn">import</span> <span class="n">get_nova_credentials_v2</span>
<span class="kn">from</span> <span class="nn">novaclient.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">print_hosts</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">get_nova_credentials_v2</span><span class="p">()</span>
<span class="n">nova_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">)</span>
<span class="n">host_list</span> <span class="o">=</span> <span class="n">nova_client</span><span class="o">.</span><span class="n">hosts</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>

<span class="n">print_hosts</span><span class="p">(</span><span class="n">host_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="footer">
      ©2015-2016, OpenStack contributors.
      
    </div>
<!--DreamCompute Button-->
<div class="dream-sign-up">
<h2>Deploy Your Apps On Cloud Servers Today</h2>
<a href="http://www.dreamhost.com/cloud/computing">Sign Up for DreamCompute</a>
</div>
</body>
