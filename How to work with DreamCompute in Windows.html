<h2>Overview</h2>
<div class="solvvy-solution">
<p>It is possible to use the <a href="https://help.dreamhost.com/hc/en-us/articles/235817468-Getting-started-with-the-OpenStack-command-line-client">OpenStack command-line interface</a> on a Windows computer by installing the following:</p>
<ul>
<li>Python</li>
<li>pip</li>
<li>C++ Build tools</li>
<li>The OpenStack client</li>
</ul>
<p>You must then set some environment variables for your Windows user. You will then be able to use Windows Command Prompt or Windows PowerShell to manage your DreamCompute project.</p>
<div class="alert alert-note">
<div class="alert-icon"><img src="https://kbimages.dreamhosters.com/images/dh-kb-note-icon.svg" width="60" height="60" /></div>
<div class="alert-content">
<p>Windows PowerShell is a command line and scripting environment. It excels at task automation and configuration management.</p>
<p>For help installing/locating Windows PowerShell, see Microsoft's documentation <a href="https://docs.microsoft.com/en-us/powershell/scripting/windows-powershell/install/installing-windows-powershell?view=powershell-7.1" target="_self">here</a>.</p>
</div>
</div>
</div>
<h2><span id="Username_and_password">Step 1 —&nbsp;</span>Install Python and pip</h2>
<div class="solvvy-solution">
<ol>
<li>Download the latest Python release from Python's website:
<ul>
<li><a href="https://www.python.org/downloads/windows/" target="_self" rel="undefined">python.org/downloads/windows</a></li>
</ul>
<div class="alert alert-note">
<div class="alert-icon"><img src="https://kbimages.dreamhosters.com/images/dh-kb-note-icon.svg" width="60" height="60" /></div>
<div class="alert-content">
<p>This article uses Python 3.8.4.</p>
</div>
</div>
<dl>
<dd><img class="img-border" src="https://kbimages.dreamhosters.com/images/dhc-windows_01.png" alt="downloading python3" /></dd>
</dl>
</li>
<li>After clicking the most recent Python 3 release, choose to download the Windows X86-64 executable installer.</li>
<li>Install Python by double-clicking the file you just downloaded.</li>
</ol>
<dl>
<dd><img class="img-border" src="https://kbimages.dreamhosters.com/images/dhc-windows_02.png" alt="downloading python3" /></dd>
</dl>
<div class="alert alert-important">
<div class="alert-icon"><img src="https://kbimages.dreamhosters.com/images/dh-kb-important-icon.svg" width="60" height="60" /></div>
<div class="alert-content">
<p>Make sure that the checkbox titled <span class="text-object">Add Python 3.8 to PATH</span> is checked&nbsp;before proceeding through the installation wizard.</p>
</div>
</div>
</div>
<h2 class="subheader"><span id="Username_and_password">Step 2 —&nbsp;</span>Install the OpenStack client</h2>
<div class="solvvy-solution">
<p>Use the command prompt to install the OpenStack client.</p>
<h3><span id="Windows_8">Windows 10</span></h3>
<ol>
<li>On the bottom left, type <span class="code">cmd</span> into the search bar.
<dl>
<dd><img class="img-border" src="https://kbimages.dreamhosters.com/images/2018-11_3rdparty_windows_command-prompt_shell_01.png" height="" /></dd>
</dl>
</li>
<li>Click on the <span class="text-object">Command Prompt</span> icon to open it</li>
<li>In the command prompt, enter the following:
<div class="preboxcontainer">
<pre class="prebox"><span class="server">C:\Users\username&gt; </span><span class="command">pip3 install python-openstackclient</span>
</pre>
</div>
</li>
</ol>
<h4><strong>Error message</strong></h4>
<p>When installing you may see this error.</p>
<div class="preboxcontainer">
<pre class="prebox">error: Microsoft Visual C++ 14.0 is required. Get it with "Build Tools for Visual Studio": https://visualstudio.microsoft.com/downloads/</pre>
</div>
<p>To fix this:</p>
<ol>
<li>Download the&nbsp;<a href="https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=BuildTools&amp;rel=16" target="_blank" rel="noopener">vs_buildtools.exe</a>&nbsp;file.</li>
<li>Click the file to run it.<br />
<dl>
<dd><img class="img-border" src="https://kbimages.dreamhosters.com/images/dhc-windows_04.png" height="" /></dd>
</dl>
</li>
<li>A pop-up window displays.<br />
<ul>
<li>Under <span class="text-section">Desktop &amp; Mobile</span> select <span class="text-object">C++ build tools</span>.</li>
</ul>
</li>
<li>Click <strong>Install</strong>.</li>
</ol>
<p>After <span class="text-object">C++ Build tools</span> has been installed, run the command again to install the openstackclient.</p>
</div>
<h2 class="subheader"><span id="Username_and_password">Step 3 —&nbsp;</span>Set environment variables</h2>
<div class="solvvy-solution">
<p>You must now set environment variables for your Windows user so your OpenStack client commands are authenticated against your project. The easiest way to do this is to download your <span class="text-object">openrc</span> file, modify/re-save it as a Windows batch file, and execute it once.</p>
<h3>Downloading your openrc file</h3>
<p>View the following article for instructions:</p>
<ul>
<li><a href="https://help.dreamhost.com/hc/en-us/articles/228047207-How-to-download-your-DreamCompute-openrc-file">How to download your DreamCompute openrc file</a></li>
</ul>
<h3>Modify the file</h3>
<p>Once you've downloaded your <span class="text-object">openrc</span> file, you'll need to modify/re-save it as a batch file. Open the file in a text editor like Notepad and remove everything except the following lines:</p>
<div class="preboxcontainer">
<pre class="prebox">export OS_AUTH_URL=https://iad2.dream.io:5000/v2.0
export OS_TENANT_ID=<span class="code-highlight">tenantid</span>
export OS_TENANT_NAME="<span class="code-highlight">tenantname</span>"
export OS_USERNAME="<span class="code-highlight">username</span>"
</pre>
</div>
<p>Make the following adjustments to the file:</p>
<ul>
<li>Replace all instances of <span class="code">export</span> with <span class="code">setx</span></li>
<li>Place double quote marks (") around all of your variable values (i.e. <span class="code">"https://iad2.dream.io:5000/v2.0"</span>, <span class="code">"tenantid"</span>, etc.).</li>
<li>Replace the <span class="text-object">=</span> sign with a space</li>
<li>Add a line using <span class="code">OS_USERNAME</span> to store your <a href="https://help.dreamhost.com/hc/en-us/articles/214442618-Resetting-your-DreamCompute-dashboard-password" target="_self">DreamCompute password</a></li>
</ul>
<p>The file should now look like this:</p>
<div class="preboxcontainer">
<pre class="prebox">setx OS_AUTH_URL "https://iad2.dream.io:5000/v2.0"
setx OS_TENANT_ID "<span class="code-highlight">tenantid</span>"
setx OS_TENANT_NAME "<span class="code-highlight">tenantname</span>"
setx OS_USERNAME "<span class="code-highlight">username</span>"
setx OS_PASSWORD "<span class="code-highlight">password</span>"</pre>
</div>
<p>Save the file with the extension <span class="text-object">.bat</span> (example: <span class="text-object">dhc-openrc.bat</span>).</p>
<div class="alert alert-note">
<div class="alert-icon"><img src="https://kbimages.dreamhosters.com/images/dh-kb-note-icon.svg" width="60" height="60" /></div>
<div class="alert-content">
<p>Make sure that the file isn't saved with an additional .txt extension or Windows will not be able to execute the script.</p>
</div>
</div>
<h3>Execute the file</h3>
<p>You must now execute the script as an administrator.</p>
<ol>
<li>Locate the saved file in Windows Explorer.</li>
<li>Right-click and select the <span class="text-object">Run as administrator</span> option.</li>
</ol>
<p>After running the script, all necessary environmental variables should be set. However, they are not set in your current Shell session. You must now quit your current shell session and open a new one.</p>
<h3>Open a new cmd prompt</h3>
<p>Quit your current shell session by typing <span class="code">exit</span>. Finally, open a new <span class="code">cmd</span> prompt. Your environmental variables will now be active. You can confirm my running the command <span class="code">set</span>.</p>
<p>You can now use the OpenStack command line client to manage your DreamCompute project. For a review of some of the basic commands, view the following article:</p>
<ul>
<li><a href="https://help.dreamhost.com/hc/en-us/articles/235817468#basic-commands" target="_self">Getting started with OpenStack command line client</a></li>
</ul>
</div>
<h2>Troubleshooting</h2>
<div class="solvvy-solution">
<h3>Check your environment variables</h3>
<p>If you're having issues connecting, double-check your environment variables. You can do this either from the <span class="text-section">System Properties Control panel</span> area, <span class="text-object">Windows PowerShell</span>, or the <span class="text-object">Windows Command Prompt</span>. In <span class="text-object">Windows PowerShell</span>, run this command:</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">C:\Users\username&gt; </span><span class="command">Get-ChildItem Env:OS_*</span>
Name                           Value
----                           -----
OS_USERNAME                    username
OS_TENANT_NAME                 tenantname
OS_AUTH_URL                    https://iad2.dream.io:5000/v2.0
OS_TENANT_ID                   tenantid
</pre>
</div>
<p>In <span class="text-object">Windows Command Prompt</span>, run this command:</p>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">C:\Users\username&gt; </span><span class="command">set|findstr OS_</span>
OS_AUTH_URL=https://iad2.dream.io:5000/v2.0
OS_TENANT_ID=tenantid
OS_TENANT_NAME=tenantname
OS_USERNAME=username
</pre>
</div>
<h3>Re-save your openrc.bat file</h3>
<p>If you find your <span class="code">OS_</span> variables are not present, view Step#3 above to save your <span class="text-object">openrc.bat</span> file correctly. You can confirm if the variables are set properly by manually running the file. For example:</p>
<ol>
<li>In your command prompt, navigate to the directory your <span class="text-object">openrc.bat</span> file is located.</li>
<li>Run the file by typing its name, then pressing the <span class="code">Enter</span> key. You should see the following output:&nbsp;
<div class="alert alert-note">
<div class="alert-icon"><img src="https://kbimages.dreamhosters.com/images/dh-kb-note-icon.svg" width="60" height="60" /></div>
<div class="alert-content">
<p>The following command assumes you've named the file <span class="text-object">dhc-openrc.bat</span>.</p>
</div>
</div>
<div class="preboxcontainer">
<pre class="prebox"><span class="server">C:\Users\username\Downloads&gt; </span><span class="command">dhc-openrc.bat</span>

C:\Users\username\Downloads&gt;setx OS_AUTH_URL "https://iad2.dream.io:5000/v2.0"
SUCCESS: Specified value was saved.

C:\Users\username\Downloads&gt;setx OS_TENANT_ID "################################"
SUCCESS: Specified value was saved.

C:\Users\username\Downloads&gt;setx OS_TENANT_NAME "#####"
SUCCESS: Specified value was saved.

C:\Users\username\Downloads&gt;setx OS_USERNAME "########"
SUCCESS: Specified value was saved.

C:\Users\username\Downloads&gt;setx OS_PASSWORD "################################"
SUCCESS: Specified value was saved.</pre>
</div>
</li>
</ol>
</div>
